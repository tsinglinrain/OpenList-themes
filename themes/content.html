<!-- Tsing2 -->
<!--延迟加载-->,
<!--如果要写自定义内容建议都加到这个延迟加载的范围内-->
<div id="customize" style="display: none;">
    <div style="max-width: 100%; margin: 0 auto; padding: 0;">
		<!--音乐播放器-->
        <meting-js list-folded="true" server="{{MUSIC_SERVER}}" type="playlist" id="{{PLAYLIST_ID}}" fixed=true>
            <pre hidden>
                [00:00.00]This
                [00:04.01]is
                [00:08.02]Waite
            </pre>
        </meting-js>

        <br />
        <center class="dibu">
            <div style="line-height: 20px;font-size: 9pt;font-weight: bold; max-width: 100%;">
                <span>
                    "
                    <span style="color: rgb(13, 109, 252); font-weight: bold;" id="hitokoto">
                        <a href="#" id="hitokoto_text">
                            "{{DEFAULT_QUOTE}}"
                        </a>
                    </span> "
                </span>
                <p style="margin-left: 10rem;font-size: 8pt;">
                    <small>
                        —— {{QUOTE_AUTHOR}}
                    </small>
                </p>
            </div>

            <div style="font-size: 13px; font-weight: bold; max-width: 100%; word-wrap: break-word;">
                
                <span class="nav-item">
                    <a class="nav-link" href="mailto:{{EMAIL}}" target="_blank">
                        <i class="fa-duotone fa-envelope-open" style="color:#409EFF" aria-hidden="true">
                        </i>
                        邮箱 |
                    </a>
                </span>
                <span class="nav-item">
                    <a class="nav-link" href="{{BLOG_URL}}" target="_blank">
                        <i class="fas fa-edit" style="color:#409EFF" aria-hidden="true">
                        </i>
                        博客 |
                    </a>
                </span>
                
                <span class="nav-item">
                    <a class="nav-link" href="{{CLOUD_URL}}" target="_blank">
                        <i class="fa fa-cloud-download" style="color:#409EFF;" aria-hidden="true">
                        </i>
                        云盘 |
                    </a>
                </span>
                <!--后台入口-->
                <span class="nav-item">
                    <a class="nav-link" href="/@manage" target="_blank">
                        <i class="fa-solid fa-folder-gear" style="color:#409EFF;" aria-hidden="true">
                        </i>
                        管理 |
                    </a>
                </span>
                <!--版权，请尊重作者-->
                <span class="nav-item">
                    <a class="nav-link" href="https://github.com/OpenListTeam/OpenList" target="_blank">
                        <i class="fa-solid fa-copyright" style="color:#409EFF;" aria-hidden="true">
                        </i>
                        Openlist
                    </a>
                </span>
                <br />
                <!--添加一个访问量-->
                <span style="word-wrap: break-word; max-width: 100%; display: inline-block;">
                    本"<span style="color: rgb(13, 109, 252); font-weight: bold;"><a href="#">目录</a></span>"访问量 <span id="busuanzi_value_page_pv" style="color: rgb(13, 109, 252); font-weight: bold;"></span> 次 本站总访问量 <span id="busuanzi_value_site_pv" style="color: rgb(13, 109, 252); font-weight: bold;"></span>                次 本站总访客数 <span id="busuanzi_value_site_uv" style="color: rgb(13, 109, 252); font-weight: bold;"></span> 人
                </span>
                <br />
                <!--添加备案信息-->
                <span class="nav-item">
                    <a class="nav-link" href="https://beian.miit.gov.cn/#/Integrated/index" target="_blank">
                        <i class="fa-solid fa-shield-check" style="color:#409EFF;" aria-hidden="true">
                        </i>
                        {{ICP_RECORD}}
                    </a>
                </span>
            </div>
        </center>
        <br />
        <br />

        <!--评论模块-->
		<center>
			<div class="giscus" id="giscus" style="max-width: 100%; box-sizing: border-box;"></div> 
		</center>
    </div>



    <!--一言API-->
    <script src="https://v1.hitokoto.cn/?encode=js&select=%23hitokoto" defer></script>
<!--延迟加载范围到这里结束-->
</div>
<!--延迟加载配套使用JS-->
<script>
    console.log("OpenList主题脚本开始执行");
    
    // 更可靠的延迟加载机制
    function showCustomizeContent() {
        const customizeDiv = document.querySelector("#customize");
        if (customizeDiv) {
            customizeDiv.style.display = "";
            console.log("✅ OpenList主题内容已显示");
            return true;
        } else {
            console.log("❌ 未找到 #customize 元素");
            return false;
        }
    }

    // 立即尝试显示（防止延迟加载失败）
    let attemptCount = 0;
    
    function attemptShow() {
        attemptCount++;
        console.log(`尝试显示内容 - 第${attemptCount}次`);
        
        if (showCustomizeContent()) {
            console.log("内容显示成功");
            return;
        }
        
        if (attemptCount < 50) { // 最多尝试50次（5秒）
            setTimeout(attemptShow, 100);
        } else {
            console.log("⚠️ 延迟加载超时，强制显示内容");
            // 强制显示
            const customizeDiv = document.querySelector("#customize");
            if (customizeDiv) {
                customizeDiv.style.display = "block";
                customizeDiv.style.visibility = "visible";
                customizeDiv.style.opacity = "1";
                console.log("强制显示完成");
            }
        }
    }

    // 多种触发条件，确保内容能够显示
    let interval = setInterval(() => {
        // 检查页面是否已经加载完成
        if (document.readyState === 'complete' || 
            document.querySelector(".footer") || 
            document.querySelector(".hope-ui-light") || 
            document.querySelector(".hope-ui-dark") ||
            document.querySelector("main") ||
            document.querySelector(".obj-box") ||
            document.body) {
            
            console.log("触发条件满足，显示内容");
            showCustomizeContent();
            clearInterval(interval);
        }
    }, 100);

    // 立即开始尝试
    attemptShow();

    // 备用触发机制
    document.addEventListener('DOMContentLoaded', function() {
        console.log("DOMContentLoaded 触发");
        setTimeout(showCustomizeContent, 500);
    });

    // 窗口加载完成后的备用触发
    window.addEventListener('load', function() {
        console.log("window.load 触发");
        setTimeout(showCustomizeContent, 300);
    });

    // 最后的保险机制 - 3秒后强制显示
    setTimeout(() => {
        const customizeDiv = document.querySelector("#customize");
        if (customizeDiv && customizeDiv.style.display === "none") {
            console.log("🔧 3秒保险机制触发，强制显示内容");
            customizeDiv.style.display = "";
        }
    }, 3000);

    function removelrc() {
        //检测是否存在歌词按钮
        if (!document.querySelector(".aplayer-icon-lrc"))
            return;
        else {
            //触发以后立刻移除监听
            document.removeEventListener("DOMNodeInserted", removelrc);
            //稍作延时保证触发函数时存在按钮
            setTimeout(function () {
                //以触发按钮的方式隐藏歌词，防止在点击显示歌词按钮时需要点击两次才能出现的问题
                document.querySelector(".aplayer-icon-lrc").click();
            }, 1);
            console.log("音乐播放器歌词已隐藏");
            return;
        }
    }

    document.addEventListener('DOMNodeInserted', removelrc)
</script>